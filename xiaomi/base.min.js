if ("undefined" == typeof XIAOMI || !XIAOMI) var XIAOMI = {};
XIAOMI.namespace = function() {
	var i, j, d, a = arguments,
		o = null;
	for (i = 0; i < a.length; i += 1) for (d = ("" + a[i]).split("."), o = XIAOMI, j = "XIAOMI" == d[0] ? 1 : 0; j < d.length; j += 1) o[d[j]] = o[d[j]] || {}, o = o[d[j]];
	return o
}, XIAOMI.lang = XIAOMI.lang || {}, function() {
	var L = XIAOMI.lang,
		OP = Object.prototype,
		ARRAY_TOSTRING = "[object Array]",
		FUNCTION_TOSTRING = "[object Function]",
		OBJECT_TOSTRING = "[object Object]",
		NOTHING = [],
		HTML_CHARS = {
			"&": "&amp;",
			"<": "&lt;",
			">": "&gt;",
			'"': "&quot;",
			"'": "&#x27;",
			"/": "&#x2F;",
			"`": "&#x60;"
		},
		ADD = ["toString", "valueOf"],
		OB = {
			isArray: function(o) {
				return OP.toString.apply(o) === ARRAY_TOSTRING
			},
			isBoolean: function(o) {
				return "boolean" == typeof o
			},
			isFunction: function(o) {
				return "function" == typeof o || OP.toString.apply(o) === FUNCTION_TOSTRING
			},
			isNull: function(o) {
				return null === o
			},
			isNumber: function(o) {
				return "number" == typeof o && isFinite(o)
			},
			isObject: function(o) {
				return o && ("object" == typeof o || L.isFunction(o)) || !1
			},
			isString: function(o) {
				return "string" == typeof o
			},
			isUndefined: function(o) {
				return "undefined" == typeof o
			},
			_IEEnumFix: -[1] ?
			function() {} : function(r, s) {
				var i, fname, f;
				for (i = 0; i < ADD.length; i += 1) fname = ADD[i], f = s[fname], L.isFunction(f) && f != OP[fname] && (r[fname] = f)
			},
			escapeHTML: function(b) {
				return b.replace(/[&<>"'\/`]/g, function(a) {
					return HTML_CHARS[a]
				})
			},
			preventDefault: function(e) {
				e.preventDefault ? e.preventDefault() : e.returnValue = !1
			},
			extend: function(a, b, c) {
				if (!b || !a) throw new Error("extend failed, please check that all dependencies are included.");
				var i, F = function() {};
				if (F.prototype = b.prototype, a.prototype = new F, a.prototype.constructor = a, a.superclass = b.prototype, b.prototype.constructor == OP.constructor && (b.prototype.constructor = b), c) {
					for (i in c) L.hasOwnProperty(c, i) && (a.prototype[i] = c[i]);
					L._IEEnumFix(a.prototype, c)
				}
			},
			augmentObject: function(r, s) {
				if (!s || !r) throw new Error("Absorb failed, verify dependencies.");
				var i, p, a = arguments,
					overrideList = a[2];
				if (overrideList && overrideList !== !0) for (i = 2; i < a.length; i += 1) r[a[i]] = s[a[i]];
				else {
					for (p in s)!overrideList && p in r || (r[p] = s[p]);
					L._IEEnumFix(r, s)
				}
				return r
			},
			augmentProto: function(r, s) {
				if (!s || !r) throw new Error("Augment failed, verify dependencies.");
				var i, a = [r.prototype, s.prototype];
				for (i = 2; i < arguments.length; i += 1) a.push(arguments[i]);
				return L.augmentObject.apply(this, a), r
			},
			dump: function(o, d) {
				var i, len, s = [],
					OBJ = "{...}",
					FUN = "f(){...}",
					COMMA = ", ",
					ARROW = " => ";
				if (!L.isObject(o)) return o + "";
				if (o instanceof Date || "nodeType" in o && "tagName" in o) return o;
				if (L.isFunction(o)) return FUN;
				if (d = L.isNumber(d) ? d : 3, L.isArray(o)) {
					for (s.push("["), i = 0, len = o.length; len > i; i += 1) s.push(L.isObject(o[i]) ? d > 0 ? L.dump(o[i], d - 1) : OBJ : o[i]), s.push(COMMA);
					s.length > 1 && s.pop(), s.push("]")
				} else {
					s.push("{");
					for (i in o) L.hasOwnProperty(o, i) && (s.push(i + ARROW), s.push(L.isObject(o[i]) ? d > 0 ? L.dump(o[i], d - 1) : OBJ : o[i]), s.push(COMMA));
					s.length > 1 && s.pop(), s.push("}")
				}
				return s.join("")
			},
			substitute: function(s, o, f, a) {
				for (var i, j, k, key, v, meta, token, dump, objstr, saved = [], lidx = s.length, DUMP = "dump", SPACE = " ", LBRACE = "{", RBRACE = "}";
				(i = s.lastIndexOf(LBRACE, lidx), !(0 > i)) && (j = s.indexOf(RBRACE, i), !(i + 1 > j));) token = s.substring(i + 1, j), key = token, meta = null, k = key.indexOf(SPACE), k > -1 && (meta = key.substring(k + 1), key = key.substring(0, k)), v = o[key], f && (v = f(key, v, meta)), L.isObject(v) ? L.isArray(v) ? v = L.dump(v, parseInt(meta, 10)) : (meta = meta || "", dump = meta.indexOf(DUMP), dump > -1 && (meta = meta.substring(4)), objstr = v.toString(), v = objstr === OBJECT_TOSTRING || dump > -1 ? L.dump(v, parseInt(meta, 10)) : objstr) : L.isString(v) || L.isNumber(v) || (v = "~-" + saved.length + "-~", saved[saved.length] = token), s = s.substring(0, i) + v + s.substring(j + 1), a === !1 && (lidx = i - 1);
				for (i = saved.length - 1; i >= 0; i -= 1) s = s.replace(new RegExp("~-" + i + "-~"), "{" + saved[i] + "}", "g");
				return s
			},
			trim: function(s) {
				try {
					return s.replace(/^\s+|\s+$/g, "")
				} catch (e) {
					return s
				}
			},
			merge: function() {
				var i, o = {},
					a = arguments,
					l = a.length;
				for (i = 0; l > i; i += 1) L.augmentObject(o, a[i], !0);
				return o
			},
			later: function(a, o, b, c, e) {
				a = a || 0, o = o || {};
				var f, r, m = b,
					d = c;
				if (L.isString(b) && (m = o[b]), !m) throw new TypeError("method undefined");
				return L.isUndefined(c) || L.isArray(d) || (d = [c]), f = function() {
					m.apply(o, d || NOTHING)
				}, r = e ? setInterval(f, a) : setTimeout(f, a), {
					interval: e,
					cancel: function() {
						this.interval ? clearInterval(r) : clearTimeout(r)
					}
				}
			},
			isValue: function(o) {
				return L.isObject(o) || L.isString(o) || L.isNumber(o) || L.isBoolean(o)
			}
		};
	L.hasOwnProperty = OP.hasOwnProperty ?
	function(o, a) {
		return o && o.hasOwnProperty && o.hasOwnProperty(a)
	} : function(o, a) {
		return !L.isUndefined(o[a]) && o.constructor.prototype[a] !== o[a]
	}, OB.augmentObject(L, OB, !0), L.augment = L.augmentProto, XIAOMI.augment = L.augmentProto, XIAOMI.extend = L.extend
}();
(function() {
	function parse(s, b, c) {
		var i = b && c || 0,
			ii = 0;
		for (b = b || [], s.toLowerCase().replace(/[0-9a-f]{2}/g, function(a) {
			16 > ii && (b[i + ii++] = _hexToByte[a])
		}); 16 > ii;) b[i + ii++] = 0;
		return b
	}

	function unparse(a, b) {
		var i = b || 0,
			bth = _byteToHex;
		return bth[a[i++]] + bth[a[i++]] + bth[a[i++]] + bth[a[i++]] + "-" + bth[a[i++]] + bth[a[i++]] + "-" + bth[a[i++]] + bth[a[i++]] + "-" + bth[a[i++]] + bth[a[i++]] + "-" + bth[a[i++]] + bth[a[i++]] + bth[a[i++]] + bth[a[i++]] + bth[a[i++]] + bth[a[i++]]
	}

	function v1(a, c, d) {
		var i = c && d || 0,
			b = c || [];
		a = a || {};
		var e = null != a.clockseq ? a.clockseq : _clockseq,
			msecs = null != a.msecs ? a.msecs : (new Date).getTime(),
			nsecs = null != a.nsecs ? a.nsecs : _lastNSecs + 1,
			dt = msecs - _lastMSecs + (nsecs - _lastNSecs) / 1e4;
		if (0 > dt && null == a.clockseq && (e = e + 1 & 16383), (0 > dt || msecs > _lastMSecs) && null == a.nsecs && (nsecs = 0), nsecs >= 1e4) throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");
		_lastMSecs = msecs, _lastNSecs = nsecs, _clockseq = e, msecs += 122192928e5;
		var f = (1e4 * (268435455 & msecs) + nsecs) % 4294967296;
		b[i++] = f >>> 24 & 255, b[i++] = f >>> 16 & 255, b[i++] = f >>> 8 & 255, b[i++] = 255 & f;
		var g = msecs / 4294967296 * 1e4 & 268435455;
		b[i++] = g >>> 8 & 255, b[i++] = 255 & g, b[i++] = g >>> 24 & 15 | 16, b[i++] = g >>> 16 & 255, b[i++] = e >>> 8 | 128, b[i++] = 255 & e;
		for (var h = a.node || _nodeId, n = 0; 6 > n; n++) b[i + n] = h[n];
		return c ? c : unparse(b)
	}

	function v4(a, b, c) {
		var i = b && c || 0;
		"string" == typeof a && (b = "binary" == a ? new o(16) : null, a = null), a = a || {};
		var d = a.random || (a.rng || j)();
		if (d[6] = 15 & d[6] | 64, d[8] = 63 & d[8] | 128, b) for (var e = 0; 16 > e; e++) b[i + e] = d[e];
		return b || unparse(d)
	}
	var j, _global = this;
	if ("function" == typeof require) try {
		var k = require("crypto").randomBytes;
		j = k &&
		function() {
			return k(16)
		}
	} catch (e) {}
	if (!j && _global.crypto && crypto.getRandomValues) {
		var l = new Uint8Array(16);
		j = function() {
			return crypto.getRandomValues(l), l
		}
	}
	if (!j) {
		var m = new Array(16);
		j = function() {
			for (var r, i = 0; 16 > i; i++) 0 === (3 & i) && (r = 4294967296 * Math.random()), m[i] = r >>> ((3 & i) << 3) & 255;
			return m
		}
	}
	for (var o = "function" == typeof Buffer ? Buffer : Array, _byteToHex = [], _hexToByte = {}, i = 0; 256 > i; i++) _byteToHex[i] = (i + 256).toString(16).substr(1), _hexToByte[_byteToHex[i]] = i;
	var p = j(),
		_nodeId = [1 | p[0], p[1], p[2], p[3], p[4], p[5]],
		_clockseq = 16383 & (p[6] << 8 | p[7]),
		_lastMSecs = 0,
		_lastNSecs = 0,
		uuid = v4;
	if (uuid.v1 = v1, uuid.v4 = v4, uuid.parse = parse, uuid.unparse = unparse, uuid.BufferClass = o, _global.define && define.amd) define(function() {
		return uuid
	});
	else if ("undefined" != typeof module && module.exports) module.exports = uuid;
	else {
		var q = _global.uuid;
		uuid.noConflict = function() {
			return _global.uuid = q, uuid
		}, _global.uuid = uuid
	}
}).call(this);
XIAOMI.namespace("app.analytics"), XIAOMI.app.analytics = function(c, d) {
	this.options = {
		page: "首页",
		position: ["A1"],
		url: !0,
		BDurl: !0,
		mstSite: "CN-WW",
		mstPage: "PC",
		mstArea: "RM",
		mstPosition: ["A"],
		mstHostParams: "",
		isMst: !1,
		JQelement: !1
	};
	for (var p in d) this.options[p] = d[p];
	for (var e = this, isUrl = e.options.url ? !0 : !1, isBDurl = e.options.BDurl ? !0 : !1, bindFunction = function(b) {
			$.each(b, function(k, v) {
				var a = isUrl ? $(v).attr("href") : XIAOMI.lang.trim($(v).text()),
					BDparamString = isBDurl ? $(v).attr("href") : XIAOMI.lang.trim($(v).text()),
					paramIndex = k,
					BDparmas_1 = e.options.page,
					BDparmas_2 = BDparmas_1 + "_" + e.options.position[i] + "_" + paramIndex,
					BDparmas_3 = BDparmas_2 + "_" + BDparamString,
					BDparmas = "'PC','" + BDparmas_3 + "'",
					mstParmas = "'" + e.options.mstSite + "-" + e.options.mstPage + "-" + e.options.mstArea + "-" + e.options.mstPosition[i] + paramIndex + "', '" + a;
				mstParmas = mstParmas += "" === e.options.mstHostParams ? "', '" + paramIndex + "'" : "', '" + e.options.mstHostParams + "'", e.options.isMst ? $(v).attr("onclick", "_msq.push(['trackEvent'," + mstParmas + "]);_hmt.push(['_trackEvent'," + BDparmas + "]);") : $(v).attr("onclick", "_hmt.push(['_trackEvent'," + BDparmas + "]);")
			})
		}, i = 0; i < c.length; i++) {
		var f = e.options.JQelement ? c[i] : $(c[i]).find("a");
		bindFunction(f)
	}
}, XIAOMI.namespace("app.updateMiniCart, app.addShopCart, app.addShopCartEvent"), XIAOMI.app.updateMiniCart = function() {
	var a = XIAOMI.app.cookie("xm_user_www_num");
	return a && parseFloat(a) > 0 ? ($(".J_cartNum").html("(" + a + ")").show(), a) : ($(".J_cartNum").html("").hide(), 0)
}, XIAOMI.app.addShopCart = function(b, c, d) {
	if (b && "function" == typeof c) {
		var e = XIAOMI.GLOBAL_CONFIG.orderSite + "/cart/add/" + b;
		$.ajax({
			url: e,
			dataType: "jsonp",
			jsonp: "jsonpcallback",
			success: function(a) {
				c(a, d), XIAOMI.app.updateMiniCart()
			}
		})
	}
}, XIAOMI.app.addShopCartEvent = function(d) {
	var e = {
		obj: ".xmAddShopCart",
		callback: null
	};
	$.extend(e, d || {}), $(document).on("click", e.obj, function() {
		var a = $(this).attr("data-gid"),
			isDisabled = $(this).attr("data-disabled"),
			isPackage = $(this).attr("data-package");
		if ("false" === isDisabled) {
			if ($(this).attr("data-disabled", "true"), !a || "true" === isPackage || null === e.callback) return !0;
			var b = XIAOMI.GLOBAL_CONFIG.damiaoGoodsId ? XIAOMI.GLOBAL_CONFIG.damiaoGoodsId : !1,
				isToDm = !1;
			if (b !== !1 && "object" == typeof b) for (var i = 0; i < b.length; i += 1) if (a === b[i]) {
				isToDm = !0;
				break
			}
			if (isToDm === !0) {
				var c = new XIAOMI.app.miniLogin;
				XIAOMI.app.cookie("serviceToken") ? XIAOMI.app.dmFun.init({
					sku: a,
					callback: e.callback,
					obj: $(this)
				}) : XIAOMI.app.cookie("userId") ? (c._proxyiframe(), XIAOMI.app.dmFun.init({
					sku: a,
					callback: e.callback,
					obj: $(this)
				})) : c._toLogin()
			} else XIAOMI.app.addShopCart(a, e.callback, $(this))
		}
		return !1
	})
}, function() {
	for (var a, noop = function() {}, methods = ["assert", "clear", "count", "debug", "dir", "dirxml", "error", "exception", "group", "groupCollapsed", "groupEnd", "info", "log", "markTimeline", "profile", "profileEnd", "table", "time", "timeEnd", "timeStamp", "trace", "warn"], length = methods.length, console = window.console = window.console || {}; length--;) a = methods[length], console[a] || (console[a] = noop)
}(), XIAOMI.namespace("app.cookie"), XIAOMI.app.cookie = function(a, b, c) {
	if (arguments.length > 1 && "[object Object]" !== String(b)) {
		if (c = jQuery.extend({}, c), (null === b || void 0 === b) && (c.expires = -1), "number" == typeof c.expires) {
			var d = c.expires,
				t = c.expires = new Date;
			t.setDate(t.getDate() + d)
		}
		return b = String(b), document.cookie = [encodeURIComponent(a), "=", c.raw ? b : encodeURIComponent(b), c.expires ? "; expires=" + c.expires.toUTCString() : "", c.path ? "; path=" + c.path : "", c.domain ? "; domain=" + c.domain : "", c.secure ? "; secure" : ""].join("")
	}
	c = b || {};
	var e, decode = c.raw ?
	function(s) {
		return s
	} : decodeURIComponent;
	return (e = new RegExp("(?:^|; )" + encodeURIComponent(a) + "=([^;]*)").exec(document.cookie)) ? decode(e[1]) : null
}, XIAOMI.namespace("app.dmFun"), XIAOMI.app.dmFun = {
	init: function(a) {
		this.config = {
			sku: null,
			callback: null,
			obj: null,
			sourceVal: "bigtap"
		}, this.inTheQueue = !1, $.extend(this.config, a), this.startQueue(), this.getDmSys();
		var b = this;
		$("#xmDmReload").on("click", function() {
			b.config.obj.trigger("click")
		})
	},
	getDmSys: function() {
		var c = this,
			hdget = XIAOMI.GLOBAL_CONFIG.damiaoSite + "hdget/cn?source=" + c.config.sourceVal + "&product=" + c.config.sku + "&addcart=1&m=1&_=" + (new Date).getTime();
		$.ajax({
			type: "GET",
			url: hdget,
			dataType: "jsonp",
			jsonp: "jsonpcallback",
			jsonpCallback: "hdcontrol",
			timeout: 3e4,
			error: function() {
				return c.inTheQueue ? (c.stopQueue(), void $("#xmDmError").modal({
					show: !0,
					backdrop: "static"
				})) : !1
			},
			success: function(a) {
				var b = a.status,
					token = b[c.config.sku].hdurl,
					isOver = b[c.config.sku].hdstart === !1 && b[c.config.sku].hdstop === !0 ? !0 : !1,
					speed = a.d22a51 ? 1e3 * a.d22a51 : 5e3;
				return c.inTheQueue ? isOver === !0 ? (c.stopQueue(), alert("抱歉，商品已售罄！"), !1) : (c.getDmTimer && clearTimeout(c.getDmTimer), void(token ? c.getShopCart(token) : (c.inTheQueue || c.startQueue(), c.getDmTimer = setTimeout(function() {
					c.getDmSys()
				}, speed)))) : !1
			}
		})
	},
	getShopCart: function(b) {
		if (!b) return !1;
		var c = this,
			addCart = XIAOMI.GLOBAL_CONFIG.orderSite + "/cart/add/" + this.config.sku + "?source=" + c.config.sourceVal + "&token=" + b;
		$.ajax({
			type: "GET",
			url: addCart,
			dataType: "jsonp",
			jsonp: "jsonpcallback",
			success: function(a) {
				c.stopQueue(), c.config.callback(a, c.config.obj), XIAOMI.app.updateMiniCart()
			}
		})
	},
	startQueue: function() {
		var a = this;
		$("#xmDmError").modal("hide"), $("#xmDmQueue").modal({
			show: !0,
			backdrop: "static"
		}), a.queueAnimate(), a.inTheQueue = !0, $("#xmDmQueue").on("hidden.bs.modal", function() {
			a.stopQueue(), a.config.obj.attr("data-disabled", "false")
		})
	},
	stopQueue: function() {
		$("#xmDmQueue").modal("hide"), this.inTheQueue = !1, this.getDmTimer && clearTimeout(this.getDmTimer), window.queueAnimateTimer && clearInterval(queueAnimateTimer)
	},
	queueAnimate: function() {
		var a = 0,
			speed = 200,
			loop = function() {
				a -= 90, -900 >= a && (a = 0), $("#mituWalking").css({
					"background-position": a + "px 0"
				})
			};
		window.queueAnimateTimer = setInterval(loop, speed)
	},
	showLoading: function() {
		var a = this;
		$("#getDmLoading").modal("show"), $("#getDmLoading").on("hidden.bs.modal", function() {
			a.config.obj.attr("data-disabled", "false")
		})
	},
	hideLoading: function() {
		$("#getDmLoading").modal("hide")
	}
}, XIAOMI.namespace("app.footer"), XIAOMI.app.footer = {
	init: function() {
		var a = this;
		a.retinizer(), a.weixin(), a.siteList(), XIAOMI.app.analytics([".J_menuNavMain"], {
			page: "导航",
			position: ["A"],
			mstPage: "HP",
			mstArea: "NV",
			mstPosition: ["A"],
			isMst: !0
		})
	},
	retinizer: function() {
		var b = new Image;
		if ("srcset" in b) return !1;
		if ("undefined" == typeof window.devicePixelRatio || window.devicePixelRatio <= 1.5) return !1;
		var c = $("img");
		c.each(function() {
			var a = $(this).attr("srcset");
			a && a.split(" 2x")[0] && $(this).attr("src", a.split(" 2x")[0])
		})
	},
	siteList: function() {
		$(".J_globalList").on({
			mouseenter: function() {
				$(this).find(".global-site-list").show()
			},
			mouseleave: function() {
				$(this).find(".global-site-list").hide()
			}
		})
	},
	weixin: function() {
		$(".J_modalWeixin").on("click", function() {
			var a = $("#J_modalWeixin");
			a.css({
				width: a.attr("data-width"),
				height: a.attr("data-height")
			}).modal({
				backdrop: !0,
				keyboard: !0,
				show: !0
			})
		})
	}
}, XIAOMI.namespace("app.getRegions"), XIAOMI.app.getRegions = {
	getUrl: "/region/index",
	getData: function(b, c, d) {
		var e = this;
		$.ajax({
			type: "GET",
			url: e.getUrl,
			data: "parent=" + b,
			dataType: "json",
			success: function(a) {
				a && e.formatData(a, c, d)
			}
		})
	},
	formatData: function(a, b, c) {
		for (var d = a.regions, lens = d.length, obj = $("#" + b), options = "<option value='0'>" + obj.children("option").eq(0).html() + "</option>", i = 0; lens > i; i += 1) {
			var e = d[i].region_id === c ? "selected" : "";
			options += "<option zipcode='" + d[i].zipcode + "' value='" + d[i].region_id + "'" + e + ">" + d[i].region_name + "</option>"
		}
		$("#" + b).html(options).attr("disabled", !1)
	}
}, XIAOMI.namespace("app.History"), XIAOMI.app.History = function() {
	var a = XIAOMI.app.cookie("XM_scan_history"),
		itemArray = null,
		goodsUrl = null;
	if (!a) return !1;
	a = a.split("#m#");
	for (var b = a.length - 1, objArr = [], i = 0; b > i; i++) {
		itemArray = a[i].split(","), goodsUrl = XIAOMI.GLOBAL_CONFIG.wwwSite + "/item/" + itemArray[3];
		var c = {};
		c.imgUrl = itemArray[0], c.goodsUrl = goodsUrl, c.name = itemArray[1], c.price = itemArray[2], c.starClass = itemArray[4], c.gid = itemArray[3], objArr.push(c)
	}
	return objArr
}, XIAOMI.namespace("app.miniCart"), XIAOMI.app.miniCart = {
	elmCartBtn: $("#J_miniCart"),
	elmCartList: $("#J_miniCartList"),
	loadingStr: '<p class="loading">数据加载中，请稍后...</p>',
	speed: 500,
	init: function() {
		var b = this,
			timeOut = null;
		return "undefined" != typeof miniCartDisable && miniCartDisable ? !1 : "undefined" != typeof XIAOMI.GLOBAL_CONFIG.closeMiniCart && "1" === XIAOMI.GLOBAL_CONFIG.closeMiniCart ? !1 : (b.elmCartBtn.on({
			mouseenter: function() {
				clearTimeout(timeOut), $(this).hasClass("mini-cart-on") || ($(this).addClass("mini-cart-on"), b.show(), b.getData())
			},
			mouseleave: function() {
				timeOut = setTimeout(function() {
					b.close()
				}, b.speed)
			}
		}), b.elmCartList.on({
			mouseenter: function() {
				clearTimeout(timeOut)
			},
			mouseleave: function() {
				timeOut = setTimeout(function() {
					b.close()
				}, b.speed)
			}
		}), void b.elmCartList.on("click", ".delItem", function(e) {
			var a = $(this).attr("gid"),
				isBigtap = $(this).attr("data-isbigtap");
			return "true" !== isBigtap || confirm("您正在删除开放购买活动商品\n\n删除后您失去本次开放购买资格，无法下单购买此商品。\n确认删除此商品吗？") ? (e.preventDefault(), void b.delGoods(a)) : !1
		}))
	},
	show: function() {
		var a = this;
		a.elmCartList.show()
	},
	close: function() {
		var a = this;
		a.elmCartBtn.removeClass("mini-cart-on"), a.elmCartList.html(this.loadingStr).hide()
	},
	delGoods: function(b) {
		var c = this;
		$.ajax({
			type: "POST",
			url: XIAOMI.GLOBAL_CONFIG.orderSite + "/cart/delete/" + b,
			dataType: "jsonp",
			jsonp: "jsonpcallback",
			cache: "false",
			success: function(a) {
				1 === a.deleteBatch && (c.getData(), XIAOMI.app.updateMiniCart())
			}
		})
	},
	getData: function() {
		var b = this;
		$.ajax({
			type: "POST",
			url: XIAOMI.GLOBAL_CONFIG.orderSite + "/cart/miniNew",
			dataType: "jsonp",
			jsonp: "jsonpcallback",
			cache: !1,
			success: function(a) {
				b.formatData(a), XIAOMI.app.updateMiniCart()
			}
		})
	},
	formatData: function(a) {
		var b = this;
		if (0 === a.errorno && a.totalItem > 0) {
			var c = a.items.length,
				goodsUrl = null,
				listHtml = "<ul>",
				countHtml = '<div class="count clearfix"><span class="total">共计 <em>' + a.total + "</em> 件商品<strong>合计：<em>" + a.totalPrice + '元</em></strong></span><a href="' + XIAOMI.GLOBAL_CONFIG.orderSite + '/cart"  class="btn btn-primary">去购物车结算</a></div>';
			if (a.totalItem > 5) {
				var d = 335;
				listHtml = '<ul style="height:' + d + 'px;overflow-x:hidden;overflow-y:scroll">'
			}
			for (var i = 0; c > i; i += 1) {
				var e = "",
					cosMask = "",
					price = a.items[i].salePrice + "元 x " + a.items[i].num;
				a.items[i].is_cos === !0 && (e = "is-cos", cosMask = '<div class="cos-mask"></div>', price = "暂时缺货"), 0 === a.items[i].noLink ? (goodsUrl = XIAOMI.GLOBAL_CONFIG.orderSite + "/item/" + a.items[i].product_id, listHtml += '<li class="clearfix ' + e + '"><a href="' + goodsUrl + '" class="pic"><img alt="" src="' + a.items[i].image_url + '?width=60&height=60"></a><a href="' + goodsUrl + '" class="name">' + a.items[i].product_name + '</a><span class="price">' + price + '</span><a class="btn-del delItem" href="javascript: void(0);" gid="' + a.items[i].itemId + '" data-isBigtap="' + a.items[i].is_bigtap + '"><i class="iconfont">&#xe607;</i></a>' + cosMask + "</li>") : listHtml += '<li class="clearfix ' + e + '"><span class="pic"><img alt="" src="' + a.items[i].image_url + '"></span><span   class="name">' + a.items[i].product_name + '</span><span class="price">' + price + '</span><a class="btn-del delItem" href="javascript: void(0);" gid="' + a.items[i].itemId + '" data-isBigtap="' + a.items[i].is_bigtap + '"><i class="iconfont">&#xe607;</i></a>' + cosMask + "</li>"
			}
			listHtml += "</ul>", b.elmCartList.html(listHtml + countHtml)
		} else 0 === a.errorno && b.elmCartList.html('<p class="loading">购物车中还没有商品，赶紧选购吧！</p>')
	}
}, XIAOMI.namespace("app.miniLogin"), XIAOMI.app.miniLogin = function() {
	this.orderSite = XIAOMI.GLOBAL_CONFIG.orderSite, this.quickLoginUrl = XIAOMI.GLOBAL_CONFIG.quickLoginUrl
}, XIAOMI.app.miniLogin.prototype = {
	constructor: XIAOMI.app.miniLogin,
	_proxyiframe: function() {
		var a = this.orderSite + "/user/proxy/stop/1",
			iframebody = "<iframe src='" + a + "' width='0' height='0' name='proxy' id='proxy' frameborder='0' scrolling='no'></iframe>";
		$(document.body).append(iframebody), $("iframe[name='proxy']").load(function() {
			$("iframe[name='proxy']").remove()
		})
	},
	_toLogin: function(c) {
		function appendTobody(a) {
			var b = a ? a : d.quickLoginUrl,
				content = "<iframe src='" + b + "' width='100%' height='100%' name='miniLoginFrame' id='miniLoginFrame' frameborder='0' scrolling='no'></iframe>",
				boxWidth = $("#loginBox").attr("data-width"),
				boxHeight = $("#loginBox").attr("data-Height");
			$("#loginBox-con").css({
				height: boxHeight
			}).html(content), $("#loginBox").css({
				width: boxWidth,
				"margin-left": -boxWidth / 2
			}).modal({
				backdrop: !0,
				keyboard: !0,
				show: !0
			})
		}

		function goLocation() {
			clearInterval(e), c ? window.location.href = c : window.location.reload(!0)
		}

		function checkHash() {
			-1 !== window.location.href.indexOf("order") ? XIAOMI.app.cookie("serviceToken") && goLocation() : XIAOMI.app.cookie("userId") && goLocation()
		}
		var d = this,
			shref = encodeURIComponent(window.location.href);
		$.ajax({
			url: d.orderSite + "/site/loginurl?followup=" + shref,
			dataType: "jsonp",
			jsonp: "jsonpcallback",
			success: function(a) {
				appendTobody(a.url)
			},
			Complete: function() {},
			error: function() {
				appendTobody()
			}
		});
		var e = window.setInterval(checkHash, 1e3)
	},
	init: function() {
		var a = this; - 1 !== window.location.pathname.indexOf("cart") && XIAOMI.app.cookie("userId") && !XIAOMI.app.cookie("serviceToken") && a._proxyiframe(), $("[data-needLogin='true']").on("click", function() {
			window.location.href = "https://account.xiaomi.com/pass/serviceLogin"
		})
	},
	_isLogined: function(a, e) {
		XIAOMI.app.cookie("serviceToken") || (XIAOMI.app.cookie("userId") ? this._proxyiframe() : (e && XIAOMI.lang.preventDefault(e), this._toLogin(a)))
	},
	autoExec: function(a) {
		this._isLogined(a)
	}
}, XIAOMI.namespace("app.navMenus, app.navigation"), XIAOMI.app.navMenus = function() {
	function toggleMenu(a, b, c, d) {
		var e, $menu, $elm = $(a);
		return e = $.extend({}, g, d), $menu = $elm.children(e.menuSelector), "toggle" === e.effect ? c ? $menu.removeClass("current").children(e.submenuSelector).hide().end().eq(b).addClass("current").children(e.submenuSelector).show() : $menu.removeClass("current").children(e.submenuSelector).hide() : "slide" === e.effect ? c ? ($menu.removeClass("current").children(e.submenuSelector).stop(!0, !0).delay(e.speed).slideUp(e.speed), $menu.eq(b).addClass("current").children(e.submenuSelector).stop(!0, !0).slideDown(e.speed)) : $menu.removeClass("current").children(e.submenuSelector).stop(!0, !0).slideUp(e.speed) : "fade" === e.effect && (c ? ($menu.removeClass("current").children(e.submenuSelector).stop(!0, !0).fadeOut(e.speed), $menu.eq(b).children(e.submenuSelector).stop(!0, !0).fadeIn(e.speed)) : $menu.removeClass("current").children(e.submenuSelector).stop(!0, !0).fadeOut(e.speed)), $menu.eq(b).children(e.submenuSelector)
	}

	function init(c, d) {
		function bindToggleEvent(a, b) {
			f.delay > 0 && "click" !== f.triggerEvent ? b ? (timeoutToggle && window.clearTimeout(timeoutToggle), timeoutToggle = window.setTimeout(function() {
				toggleMenu($elm, a, !0, f)
			}, f.delay)) : (window.clearTimeout(timeoutToggle), timeoutToggle = window.setTimeout(function() {
				toggleMenu($elm, a, !1, f)
			}, f.delay)) : b ? toggleMenu($elm, a, !0, f) : toggleMenu($elm, a, !1, f), "function" == typeof f.callback && f.callback($elm, a, f)
		}
		var f, $menu, timeoutToggle, $elm = $(c);
		return 0 === $elm.length ? $elm : $elm.length > 1 ? ($elm.each(function() {
			init($(this), d)
		}), this) : (f = $.extend({}, g, d), $menu = $elm.children(f.menuSelector), "hover" === f.triggerEvent ? $menu.on({
			mouseenter: function() {
				bindToggleEvent($menu.index($(this)), !0)
			},
			mouseleave: function() {
				bindToggleEvent($menu.index($(this)), !1)
			}
		}) : "click" === f.triggerEvent && $menu.on("click", function(e) {
			e.preventDefault(), $(this).hasClass("toggled") ? ($(this).removeClass("toggled"), bindToggleEvent($menu.index($(this)), !1)) : ($menu.removeClass("toggled"), $(this).addClass("toggled"), bindToggleEvent($menu.index($(this)), !0))
		}), void(window.ActiveXObject && !window.XMLHttpRequest && $menu.find(f.submenuSelector).find("a").on("click", function() {
			window.location.href = $(this).attr("href")
		})))
	}
	var g;
	return g = {
		menuSelector: ".menu",
		submenuSelector: ".children",
		triggerEvent: "hover",
		effect: "toggle",
		delay: 200,
		speed: 200,
		callback: function() {}
	}, {
		toggleMenu: toggleMenu,
		init: init
	}
}(), XIAOMI.app.navCategory = function() {
	function lazyLoadImg(a) {
		var b = $(a);
		b.each(function() {
			$(this).hasClass("img-loaded") || "string" != typeof $(this).attr("data-src") || $(this).addClass("img-loaded").attr({
				src: $(this).attr("data-src")
			})
		})
	}

	function toggleCategoryList(a) {
		"show" === a ? (f.addClass("nav-category-toggled"), $categoryTriggerBtn.find(".iconfont").html("&#xe606;"), $categoryList.show()) : "static" === a ? (f.addClass("nav-category-toggled"), $categoryList.show()) : (f.removeClass("nav-category-toggled"), $categoryTriggerBtn.find(".iconfont").html("&#xe608;"), $categoryList.hide().find(".nav-category-list").children("li").removeClass("current"))
	}

	function bindChildrenList() {
		var d;
		$categoryList.find(".nav-category-list").children("li").on({
			mouseenter: function() {
				var c = $(this);
				window.clearTimeout(d), c.hasClass("current") || (d = window.setTimeout(function() {
					c.addClass("current").siblings("li").removeClass("current");
					var a = c.find(".nav-category-children");
					if (a.length) {
						if (a.offset().top - f.offset().top - f.height() + a.height() > $categoryList.height()) {
							var b = a.offset().top - f.offset().top - f.height() + 73 - $categoryList.height();
							a.css({
								top: "auto",
								bottom: b
							})
						}
						lazyLoadImg(a.find("img"))
					}
				}, 100))
			},
			mouseleave: function() {
				var a = $(this);
				window.clearTimeout(d), d = window.setTimeout(function() {
					a.removeClass("current")
				}, 100)
			}
		})
	}

	function init() {
		function addSrcset(b) {
			var c = b.find("img");
			c.each(function() {
				if (/40x40/.test($(this).attr("data-src"))) {
					var a = $(this).attr("data-src").replace("40x40", "80x80");
					$(this).attr("srcset", a + " 2x")
				}
			})
		}
		var d = "undefined" != typeof isCategoryToggled ? isCategoryToggled : !1,
			templateHtml = '{{? it.children}}<li class="nav-category-item nav-category-item-first"><div class="nav-category-content"><a class="title" href="' + XIAOMI.GLOBAL_CONFIG.wwwSite + '/event/buyphone">购买手机</a><div class="links"><a href="' + XIAOMI.GLOBAL_CONFIG.wwwSite + '/buyphone/mi4">小米4</a><a href="' + XIAOMI.GLOBAL_CONFIG.wwwSite + '/buyphone/mi3">小米3</a><a href="' + XIAOMI.GLOBAL_CONFIG.wwwSite + '/buyphone/hongmi1s">红米</a><a href="' + XIAOMI.GLOBAL_CONFIG.wwwSite + '/buyphone/note">红米Note</a></div><div class="nav-category-children"><ul class="children-list"><li><a href="http://www.mi.com/buyphone/mi4"><img src="http://img03.mifile.cn/webfile/images/2014/cn/loading.gif" data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mi4.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mi4_2x.jpg 2x" alt="购买小米手机4"><span class="text">小米手机4</span></a></li><li><a href="http://www.mi.com/buyphone/mi3"><img src="http://img03.mifile.cn/webfile/images/2014/cn/loading.gif" data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mi3.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mi3_2x.jpg 2x" alt="购买小米手机3"><span class="text">小米手机3</span></a></li><li><a href="http://www.mi.com/buyphone/hongmi1s"><img src="http://img03.mifile.cn/webfile/images/2014/cn/loading.gif" data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/redmi1s.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/redmi1s_2x.jpg 2x" alt="购买红米手机1S"><span class="text">红米手机1S</span></a></li><li><a href="http://www.mi.com/buyphone/note"><img src="http://img03.mifile.cn/webfile/images/2014/cn/loading.gif" data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/redminote.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/redminote_2x.jpg 2x" alt="购买红米Note"><span class="text">红米Note</span></a></li><li><a href="http://www.mi.com/c/peijian/"><img src="http://img03.mifile.cn/webfile/images/2014/cn/loading.gif" data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/typeacc.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/typeacc_2x.jpg 2x" alt="根据机型选配件"><span class="text">根据机型选配件</span></a></li></ul><div class="children-special-section"><h4>明星配件</h4><ul><li><a href="http://www.mi.com/shouhuan">小米手环 79元</a></li><li><a href="http://www.mi.com/accessories/102">小米活塞耳机 99元</a></li></ul></div></div></div></li><li class="nav-category-item"><div class="nav-category-content"><a class="title" href="javascript: void(0);">购买电视与平板</a><div class="links"><a href="' + XIAOMI.GLOBAL_CONFIG.wwwSite + '/mitv">小米电视</a><a href="' + XIAOMI.GLOBAL_CONFIG.wwwSite + '/static/buyhezi">小米盒子</a><a href="' + XIAOMI.GLOBAL_CONFIG.wwwSite + '/static/buymipad">小米平板</a></div><div class="nav-category-children"><ul class="children-list"><li><a href="http://www.mi.com/mitv"><img src="http://img03.mifile.cn/webfile/images/2014/cn/loading.gif" data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mitv.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mitv_2x.jpg 2x" alt="购买小米电视2"><span class="text">小米电视2</span></a></li><li><a href="http://www.mi.com/static/buyhezi"><img src="http://img03.mifile.cn/webfile/images/2014/cn/loading.gif" data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mibox.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mibox_2x.jpg 2x" alt="购买小米盒子"><span class="text">小米盒子</span></a></li><li><a href="http://www.mi.com/static/buymipad"><img src="http://img03.mifile.cn/webfile/images/2014/cn/loading.gif" data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mipad.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mipad_2x.jpg 2x" alt="购买小米平板"><span class="text">小米平板</span></a></li></ul><div class="children-special-section"><h4>明星配件</h4><ul><li><a href="http://www.mi.com/accessories/0-256">小米电视配件</a></li><li><a href="http://www.mi.com/accessories/0-8">小米盒子配件</a></li><li><a href="http://www.mi.com/accessories/0-4567890">小米平板配件</a></li></ul></div></div></li>{{~it.children :value:index}} {{? index < 6}}<li class="nav-category-item"><div class="nav-category-content"><a class="title" href="' + XIAOMI.GLOBAL_CONFIG.wwwSite + '/accessories/{{= value.cat_id }}">{{= value.name_alias || value.cat_name }}</a><div class="links">{{~value.highlight_children :highlight_value:highlight_index}}<a href="' + XIAOMI.GLOBAL_CONFIG.wwwSite + '/accessories/{{= highlight_value.cat_id }}">{{= highlight_value.cat_name }}</a>{{~}}</div>{{? value.children}}<div class="nav-category-children"><ul class="children-list">{{~value.children :children_value:children_index}}<li><a href="' + XIAOMI.GLOBAL_CONFIG.wwwSite + '/accessories/{{= children_value.cat_id }}"><img src="http://img03.mifile.cn/webfile/images/2014/cn/loading.gif" data-src="{{= children_value.cat_icon }}" alt="{{= children_value.cat_name }}"><span class="text">{{= children_value.cat_name }}</span></a></li>{{~}}</ul>{{? value.topsales.length > 0 }}<div class="children-special-section"><h4>热门商品</h4><ul>{{~value.topsales :topsales_value:topsales_index}}<li><a href="' + XIAOMI.GLOBAL_CONFIG.wwwSite + '/item/{{= topsales_value.id}}">{{= topsales_value.name_alias || topsales_value.name }} {{= topsales_value.price_max }}元</a></li>{{~}}</ul></div>{{?}}</div>{{?}}</div></li>{{?}} {{~}}{{?}}',
			templateCategory = doT.template(templateHtml);
		if ("undefined" == typeof categoryTree) return !1;
		if ($("#J_categoryContainer").find(".nav-category-list").html(templateCategory(categoryTree)), addSrcset($(".nav-category-list")), XIAOMI.app.analytics([$(".nav-category-content > a"), $(".nav-category-content .links").find("a"), $(".nav-category-content .children-list").find("a"), $(".nav-category-content .children-special-section").find("a")], {
			page: "分类导航",
			position: ["A", "B", "C", "D"],
			mstPage: "HP",
			mstArea: "PC",
			mstPosition: ["A", "B", "C", "D"],
			JQelement: !0,
			isMst: !0,
			BDurl: !1
		}), d) toggleCategoryList("static");
		else {
			$categoryTriggerBtn.append('<i class="iconfont">&#xe608;</i>');
			var e;
			f.on({
				mouseenter: function() {
					window.clearTimeout(e), $(this).hasClass("nav-category-toggled") || (e = window.setTimeout(function() {
						toggleCategoryList("show")
					}, 200))
				},
				mouseleave: function() {
					window.clearTimeout(e), $(this).hasClass("nav-category-toggled") && (e = window.setTimeout(function() {
						toggleCategoryList("hide")
					}, 200))
				}
			})
		}
		bindChildrenList()
	}
	var f = $("#J_categoryContainer"),
		$categoryTriggerBtn = f.children(".btn-category-list"),
		$categoryList = f.children(".nav-category-section");
	return {
		init: init
	}
}(), XIAOMI.namespace("app.placeholder"), XIAOMI.app.placeholder = function(a, b) {
	var c, options, elmPlaceholder, elm = $(a),
		isPlaceholderSupported = "placeholder" in document.createElement("input");
	return 0 === elm.length ? elm : elm.length > 1 ? (elm.each(function() {
		XIAOMI.app.placeholder($(this), b)
	}), this) : (c = {
		blurClass: "xm-ph-blur"
	}, options = $.extend({}, c, b), elmPlaceholder = elm.attr("placeholder"), void(!isPlaceholderSupported && elmPlaceholder && (elm.is("textarea") ? "" === elm.html() && elm.addClass(options.blurClass).html(elmPlaceholder) : "" === elm.val() && elm.addClass(options.blurClass).val(elmPlaceholder), elm.on({
		focus: function() {
			$(this).is("textarea") ? $(this).html() === elmPlaceholder && $(this).removeClass(options.blurClass).html("") : $(this).val() === elmPlaceholder && $(this).removeClass(options.blurClass).val("")
		},
		blur: function() {
			$(this).is("textarea") ? "" === $(this).html() && $(this).addClass(options.blurClass).html(elmPlaceholder) : "" === $(this).val() && $(this).addClass(options.blurClass).val(elmPlaceholder)
		}
	}))))
}, XIAOMI.namespace("app.carousel"), XIAOMI.app.carousel = function() {
	function init(c, d) {
		function slideList(a) {
			var b = "-" + a * itemWidth * itemPerSlide + "px";
			$list.animate({
				"margin-left": b
			}, f.speed), a > 0 && countPage - 1 > a ? ($btnPrev.removeClass("page-btn-prev-disabled"), $btnNext.removeClass("page-btn-next-disabled")) : 0 === a ? ($btnPrev.addClass("page-btn-prev-disabled"), $btnNext.removeClass("page-btn-next-disabled")) : a === countPage - 1 && ($btnPrev.removeClass("page-btn-prev-disabled"), $btnNext.addClass("page-btn-next-disabled"))
		}

		function autoPlay() {
			return 0 >= countPage ? !1 : void(timeoutAuto = setInterval(function() {
				curIndex += 1, curIndex > countPage - 1 && (curIndex = 0), slideList(curIndex)
			}, f.delay))
		}
		var f, $listWrap, $list, $btnPrev, $btnNext, itemLength, itemWidth, itemHeight, itemPerSlide, countPage, timeoutAuto, $elm = $(c),
			curIndex = 0;
		return 0 === $elm.length ? $elm : $elm.length > 1 ? ($elm.each(function() {
			init($(this), d)
		}), this) : (f = $.extend({}, g, d), $listWrap = $elm.find(f.listWrapSelector), $list = $listWrap.find(f.listSelector), $btnPrev = $elm.find(f.prevBtnSelector), $btnNext = $elm.find(f.nextBtnSelector), itemWidth = f.itemWidth || $list.children(f.itemSelector).outerWidth(), itemHeight = f.itemHeight || $list.children(f.itemSelector).outerHeight() - 1, itemLength = $list.children(f.itemSelector).length, itemPerSlide = 4 !== itemLength ? Math.ceil($listWrap.width() / itemWidth) : 4, countPage = Math.ceil(itemLength / itemPerSlide), 1 === countPage && ($btnPrev.hide(), $btnNext.hide()), $listWrap.css({
			height: itemHeight
		}), $list.css({
			width: itemWidth * itemLength,
			"margin-left": 0
		}), $btnPrev.addClass("page-btn-prev-disabled"), 1 >= countPage && $btnNext.addClass("page-btn-next-disabled"), f.autoPlay && (autoPlay(), $elm.on({
			mouseenter: function() {
				timeoutAuto && clearInterval(timeoutAuto)
			},
			mouseleave: function() {
				autoPlay()
			}
		})), $btnPrev.off().on("click", function(e) {
			e.preventDefault(), $(this).hasClass("page-btn-prev-disabled") || (curIndex -= 1, 0 >= curIndex && (curIndex = 0, $(this).addClass("page-btn-prev-disabled")), $btnNext.removeClass("page-btn-next-disabled"), slideList(curIndex))
		}), void $btnNext.off().on("click", function(e) {
			e.preventDefault(), $(this).hasClass("page-btn-next-disabled") || (curIndex += 1, curIndex > countPage - 1 && (curIndex = countPage - 1, $(this).addClass("page-btn-next-disabled")), $btnPrev.removeClass("page-btn-prev-disabled"), slideList(curIndex))
		}))
	}
	var g;
	return g = {
		listWrapSelector: ".J_carouselWrap",
		listSelector: ".J_carouselList",
		itemSelector: "li",
		prevBtnSelector: ".J_carouselPrev",
		nextBtnSelector: ".J_carouselNext",
		itemWidth: null,
		itemHeight: null,
		autoPlay: !0,
		speed: 500,
		delay: 5e3
	}, {
		init: init
	}
}(), XIAOMI.namespace("app.search"), XIAOMI.app.search = {
	speed: 200,
	inputObj: null,
	keyword: null,
	init: function() {
		var a, _this = this,
			timeOut = null,
			$searchForm = $("#J_searchForm"),
			searchConfig = {};
		_this.inputObj = $searchForm.find(".search-text"), _this.inputObj.data("search-config") && (searchConfig = $.parseJSON(_this.inputObj.data("search-config").replace(/'/g, '"'))), $searchForm.append($('<div id="J_keywordList" class="keyword-list hide"><ul class="result-list"></ul></div>')), _this.inputObj.on({
			focus: function() {
				window.clearTimeout(a), $("#J_keywordList").css("opacity", 1), $searchForm.addClass("search-form-focus"), !$(this).val() && searchConfig.defaultWords && _this.formatData(searchConfig.defaultWords)
			},
			blur: function() {
				$("#J_keywordList").css("opacity", 0), a = window.setTimeout(function() {
					$searchForm.removeClass("search-form-focus")
				}, 200)
			},
			keyup: function(e) {
				$.trim($(this).val()).length <= 0 && searchConfig.defaultWords && (_this.keyword = null, _this.formatData(searchConfig.defaultWords)), _this.focusMove(e.which), clearTimeout(timeOut), 40 !== e.which && 38 !== e.which && (timeOut = setTimeout(function() {
					_this.keyword = _this.inputObj.val(), _this.getResult(_this.keyword)
				}, _this.speed))
			}
		}), $searchForm.on("mouseenter", "#J_keywordList li", function() {
			$(this).addClass("current").siblings().removeClass("current")
		}), _this.submit()
	},
	getResult: function(k) {
		var b = this;
		k && $.ajax({
			type: "GET",
			url: XIAOMI.GLOBAL_CONFIG.wwwSite + "/search/tips?keyword=" + encodeURIComponent(k),
			dataType: "jsonp",
			jsonp: "jsonpcallback",
			jsonpCallback: "xmsearch",
			cache: !0,
			success: function(a) {
				a.length > 0 ? b.inputObj.val() && b.formatData(a) : b.removeList()
			}
		})
	},
	formatData: function(a) {
		for (var b = "", i = 0, lens = a.length; lens > i; i += 1) {
			var c = a[i].replace(this.keyword, '<span class="keyword">' + this.keyword + "</span> ");
			b += '<li data-key="' + a[i] + '"><a href="' + XIAOMI.GLOBAL_CONFIG.wwwSite + "/search_" + encodeURIComponent(a[i]) + '">' + c + "</a></li>"
		}
		$("#J_keywordList").removeClass("hide").children(".result-list").html(b)
	},
	focusMove: function(a) {
		var b = this,
			$keywordList = $("#J_keywordList"),
			$items = $keywordList.find("li"),
			i = $keywordList.find(".current").index() || 0,
			lens = $items.length - 1;
		if (38 === a) {
			if (i -= 1, 0 > i) return i = 0, !1;
			$items.eq(i).addClass("current").siblings().removeClass("current"), b.inputObj.val($items.eq(i).attr("data-key"))
		} else if (40 === a) {
			if (i += 1, i > lens) return i = lens, !1;
			$items.eq(i).addClass("current").siblings().removeClass("current"), b.inputObj.val($items.eq(i).attr("data-key"))
		}
	},
	removeList: function() {
		$("#J_keywordList").addClass("hide").children(".result-list").html("")
	},
	submit: function() {
		var b = this;
		$("#J_searchForm").on("submit", function() {
			var a = $.trim(b.inputObj.val());
			return "" !== a && (a = a.replace(/[\-_'=+|\\\/]/g, " "), window.location.href = XIAOMI.GLOBAL_CONFIG.wwwSite + "/search_" + encodeURIComponent(a)), !1
		})
	}
}, XIAOMI.namespace("app.selector"), XIAOMI.app.selector = {
	defaultOption: {
		reorder: !1,
		buildLI: function(a, b, c) {
			var d = $('<li data-index="' + a + '"><span>' + b.text + "</span></li>");
			b.selected && d.addClass("selected"), c.append(d)
		},
		afterChange: function() {}
	},
	init: function(c, d) {
		function reorderList(a) {
			a.insertBefore(a.closest("ul").children("li")[0]), elmText.text(a.text())
		}
		var e, elmSelect, elmWrap, elmText, elmList, elmArrow, _this = this,
			data = [];
		return 0 === c.length ? c : c.length > 1 ? (c.each(function() {
			_this.init($(this), d)
		}), this) : (e = $.extend({}, _this.defaultOption, d), elmSelect = c, elmWrap = $('<div class="xm-select"></div>').insertAfter(elmSelect), elmText = $('<div class="dropdown-text"></div>'), elmList = $('<ul class="dropdown-menu"></ul>'), elmArrow = $('<span class="arrow-down"></span>'), elmSelect.children("option").each(function() {
			data.push({
				text: $(this).text(),
				value: $(this).attr("value"),
				selected: $(this).attr("selected")
			})
		}), $(data).each(function(a, b) {
			e.buildLI(a, b, elmList)
		}), elmWrap.append(elmText, elmList, elmArrow, elmSelect), elmSelect.hide(), e.reorder === !0 && 0 !== elmList.children("li").index(elmList.children(".selected")) ? reorderList(elmList.children(".selected")) : elmText.text(data[0].text), elmList.on("click", "li", function() {
			var a = elmSelect.children("option").eq($(this).attr("data-index")).val();
			elmSelect.val(a).change(), $(this).addClass("selected").siblings("li").removeClass("selected"), e.reorder === !0 ? 0 !== elmList.children("li").index(this) && (reorderList($(this)), elmList.hide()) : (elmText.text($(this).text()), elmList.hide()), e.afterChange(a)
		}), void elmWrap.on({
			mouseover: function() {
				elmWrap.addClass("toggled"), elmList.show()
			},
			mouseout: function() {
				elmWrap.removeClass("toggled"), elmList.hide()
			}
		}))
	}
}, XIAOMI.namespace("app.setLoginInfo"), XIAOMI.app.setLoginInfo = {
	data: {
		userId: 0,
		userName: "",
		goodsNum: 0
	},
	miid: XIAOMI.app.cookie("userId"),
	defautConfig: {},
	init: function(c) {
		var d = this;
		this.config = $.extend({}, c, this.defautConfig), this.uuidCookie(), this.miid && 0 != this.miid ? (this.data.userName = this.miid ? XIAOMI.app.cookie("XM_" + this.miid + "_UN") : "", this.data.goodsNum = XIAOMI.app.cookie("xm_user_www_num"), this.data.goodsNum = null == this.data.goodsNum ? 0 : this.data.goodsNum, null == this.data.userName || "" === this.data.userName ? d.createScript(this.miid) : this.updateDom(this.miid)) : $.ajax({
			dataType: "JSONP",
			url: "http://userid.xiaomi.com/userId",
			jsonpCallback: "userLogincallback",
			success: function(a) {
				if (0 != a.userId && null != a.userId) {
					var b = {
						path: "/",
						domain: ".mi.com"
					};
					XIAOMI.app.cookie("userId", a.userId, b), d.createScript(a.userId)
				}
			}
		})
	},
	createScript: function(a) {
		this.updateDom(a);
		var b = document.createElement("script");
		b.src = "https://account.xiaomi.com/pass/userInfoJsonP?userId=" + a + "&callback=setLoginInfo_getAccountInfo", b.type = "text/javascript", b.async = !0, document.getElementsByTagName("head")[0].appendChild(b)
	},
	updateDom: function(a) {
		var b = this.data.userName;
		null != b && "" !== b ? b.length > 7 && (b = b.substr(0, 7) + "…") : b = a;
		var c = "undefined" != typeof XIAOMI.app.cookie("userId") ? XIAOMI.app.cookie("userId") : "";
		c += "_t" + (new Date).getTime();
		var d, html = '欢迎您 <b class="user-name">' + b + '<span class="arrow"></span></b><span class="sep">|</span><a href="' + this.config.orderSite + "/user/order?r=" + c + '">我的订单</a><span class="sep">|</span><a href="http://account.xiaomi.com/" target="_blank">我的小米账户</a>',
			$userInfoMenu = $('<div class="user-info-menu"><ul><li><a href="http://my.mi.com/portal" target="_blank">个人中心</a></li><li><a href="' + XIAOMI.GLOBAL_CONFIG.orderSite + '/user/favorite">我的收藏</a></li><li><a href="' + this.config.logoutUrl + '">退出登录</a></li></ul><span class="menu-arrow"></span></div>');
		$(".J_userInfo").html(html).append($userInfoMenu).on({
			mouseenter: function() {
				d && window.clearTimeout(d), $userInfoMenu.show()
			},
			mouseleave: function() {
				d = window.setTimeout(function() {
					$userInfoMenu.hide()
				}, 200)
			}
		}, ".user-name"), $userInfoMenu.on({
			mouseenter: function() {
				d && window.clearTimeout(d)
			},
			mouseleave: function() {
				d = window.setTimeout(function() {
					$userInfoMenu.hide()
				}, 200)
			}
		})
	},
	uuidCookie: function() {
		var a = ("xmguest-" + uuid.v1()).toUpperCase(),
			myUuid = XIAOMI.app.cookie("xmuuid");
		if (!myUuid) {
			var b = {
				path: "/",
				domain: ".mi.com",
				expires: 18250
			};
			XIAOMI.app.cookie("xmuuid", a, b)
		}
	}
};
var setLoginInfo_getAccountInfo = function(a) {
		var b = XIAOMI.app.setLoginInfo;
		if (a.userId) {
			b.data.userName = a.uniqName ? a.uniqName : a.userId;
			var c = {
				path: "/",
				domain: ".mi.com"
			};
			XIAOMI.app.cookie("XM_" + b.miid + "_UN", b.data.userName, c), b.updateDom(a.userId)
		}
	};
XIAOMI.namespace("setRecommend"), XIAOMI.app.setRecommend = function(d) {
	var e = {
		obj: $("#item-recommend-box"),
		tmpl: $("#item-recommend-template"),
		url: XIAOMI.GLOBAL_CONFIG.sideBarApiUrl + "cart/get/id/1134900361,1134900465,1135000458,1140400001/callback/itemRecommend/cid/2",
		max: 5,
		min: 0,
		callback: null
	};
	$.extend(e, d || {}), $(e.obj).show(), $.ajax({
		dataType: "JSONP",
		url: e.url,
		jsonpCallback: "itemRecommend",
		success: function(a) {
			var b = doT.template($(e.tmpl).html()),
				result = a.result,
				itemList = [];
			for (var c in result) c < e.max && itemList.push(result[c]);
			return itemList.length < e.min ? !1 : void(0 !== itemList.length && "error" !== result ? ($(e.obj).html(b(itemList)), null !== e.callback && "function" == typeof e.callback && e.callback()) : $(e.obj).hide())
		}
	})
}; +
function($) {
	"use strict";

	function transitionEnd() {
		var a = document.createElement("bootstrap"),
			transEndEventNames = {
				WebkitTransition: "webkitTransitionEnd",
				MozTransition: "transitionend",
				OTransition: "oTransitionEnd otransitionend",
				transition: "transitionend"
			};
		for (var b in transEndEventNames) if (void 0 !== a.style[b]) return {
			end: transEndEventNames[b]
		};
		return !1
	}
	$.fn.emulateTransitionEnd = function(a) {
		var b = !1,
			$el = this;
		$(this).one($.support.transition.end, function() {
			b = !0
		});
		var c = function() {
				b || $($el).trigger($.support.transition.end)
			};
		return setTimeout(c, a), this
	}, $(function() {
		$.support.transition = transitionEnd()
	})
}(jQuery);
!
function($) {
	"use strict";
	var d = function(a, b) {
			this.options = b, this.$element = $(a).delegate('[data-dismiss="modal"]', "click.dismiss.modal", $.proxy(this.hide, this)), this.options.remote && this.$element.find(".modal-body").load(this.options.remote)
		};
	d.prototype = {
		constructor: d,
		toggle: function() {
			return this[this.isShown ? "hide" : "show"]()
		},
		show: function() {
			var b = this,
				e = $.Event("show");
			this.$element.trigger(e), this.isShown || e.isDefaultPrevented() || (this.isShown = !0, this.escape(), this.backdrop(function() {
				var a = $.support.transition && b.$element.hasClass("fade");
				b.$element.parent().length || b.$element.appendTo(document.body), b.$element.show(), a && b.$element[0].offsetWidth, b.$element.addClass("in").attr("aria-hidden", !1), b.enforceFocus(), a ? b.$element.one($.support.transition.end, function() {
					b.$element.focus().trigger("shown")
				}) : b.$element.focus().trigger("shown")
			}))
		},
		hide: function(e) {
			e && e.preventDefault();
			e = $.Event("hide"), this.$element.trigger(e), this.isShown && !e.isDefaultPrevented() && (this.isShown = !1, this.escape(), $(document).off("focusin.modal"), this.$element.removeClass("in").attr("aria-hidden", !0), $.support.transition && this.$element.hasClass("fade") ? this.hideWithTransition() : this.hideModal())
		},
		enforceFocus: function() {
			var a = this;
			$(document).on("focusin.modal", function(e) {
				a.$element[0] === e.target || a.$element.has(e.target).length || a.$element.focus()
			})
		},
		escape: function() {
			var a = this;
			this.isShown && this.options.keyboard ? this.$element.on("keyup.dismiss.modal", function(e) {
				27 == e.which && a.hide()
			}) : this.isShown || this.$element.off("keyup.dismiss.modal")
		},
		hideWithTransition: function() {
			var a = this,
				timeout = setTimeout(function() {
					a.$element.off($.support.transition.end), a.hideModal()
				}, 500);
			this.$element.one($.support.transition.end, function() {
				clearTimeout(timeout), a.hideModal()
			})
		},
		hideModal: function() {
			var a = this;
			this.$element.hide(), this.backdrop(function() {
				a.removeBackdrop(), a.$element.trigger("hidden")
			})
		},
		removeBackdrop: function() {
			this.$backdrop && this.$backdrop.remove(), this.$backdrop = null
		},
		backdrop: function(a) {
			var b = this.$element.hasClass("fade") ? "fade" : "";
			if (this.isShown && this.options.backdrop) {
				var c = $.support.transition && b,
					pageHeight = $(document).height(),
					pageWidth = "100%";
				if (this.$backdrop = $('<div class="modal-backdrop ' + b + '" />').appendTo(document.body), this.$backdrop.css({
					width: pageWidth,
					height: pageHeight
				}).click("static" == this.options.backdrop ? $.proxy(this.$element[0].focus, this.$element[0]) : $.proxy(this.hide, this)), c && this.$backdrop[0].offsetWidth, this.$backdrop.addClass("in"), !a) return;
				c ? this.$backdrop.one($.support.transition.end, a) : a()
			} else!this.isShown && this.$backdrop ? (this.$backdrop.removeClass("in"), $.support.transition && this.$element.hasClass("fade") ? this.$backdrop.one($.support.transition.end, a) : a()) : a && a()
		}
	};
	var f = $.fn.modal;
	$.fn.modal = function(b) {
		return this.each(function() {
			var a = $(this),
				data = a.data("modal"),
				options = $.extend({}, $.fn.modal.defaults, a.data(), "object" == typeof b && b);
			data || a.data("modal", data = new d(this, options)), "string" == typeof b ? data[b]() : options.show && data.show()
		})
	}, $.fn.modal.defaults = {
		backdrop: !0,
		keyboard: !0,
		show: !0
	}, $.fn.modal.Constructor = d, $.fn.modal.noConflict = function() {
		return $.fn.modal = f, this
	}, $(document).on("click.modal.data-api", '[data-toggle="modal"]', function(e) {
		var a = $(this),
			href = a.attr("href"),
			$target = $(a.attr("data-target") || href && href.replace(/.*(?=#[^\s]+$)/, "")),
			option = $target.data("modal") ? "toggle" : $.extend({
				remote: !/#/.test(href) && href
			}, $target.data(), a.data());
		e.preventDefault(), $target.modal(option).one("hide", function() {
			a.focus()
		})
	})
}(window.jQuery);
!
function() {
	"use strict";

	function encodeHTMLSource() {
		var a = {
			"&": "&#38;",
			"<": "&#60;",
			">": "&#62;",
			'"': "&#34;",
			"'": "&#39;",
			"/": "&#47;"
		},
			matchHTML = /&(?!#?\w+;)|<|>|"|'|\//g;
		return function() {
			return this ? this.replace(matchHTML, function(m) {
				return a[m] || m
			}) : this
		}
	}

	function resolveDefs(c, f, g) {
		return ("string" == typeof f ? f : f.toString()).replace(c.define || skip, function(m, b, d, e) {
			return 0 === b.indexOf("def.") && (b = b.substring(4)), b in g || (":" === d ? (c.defineParams && e.replace(c.defineParams, function(m, a, v) {
				g[b] = {
					arg: a,
					text: v
				}
			}), b in g || (g[b] = e)) : new Function("def", "def['" + b + "']=" + e)(g)), ""
		}).replace(c.use || skip, function(m, e) {
			c.useParams && (e = e.replace(c.useParams, function(m, s, d, a) {
				if (g[d] && g[d].arg && a) {
					var b = (d + ":" + a).replace(/'|\\/g, "_");
					return g.__exp = g.__exp || {}, g.__exp[b] = g[d].text.replace(new RegExp("(^|[^\\w$])" + g[d].arg + "([^\\w$])", "g"), "$1" + a + "$2"), s + "def.__exp['" + b + "']"
				}
			}));
			var v = new Function("def", "return " + e)(g);
			return v ? resolveDefs(c, v, g) : v
		})
	}

	function unescape(a) {
		return a.replace(/\\('|\\)/g, "$1").replace(/[\r\t\n]/g, " ")
	}
	var h, doT = {
		version: "1.0.0",
		templateSettings: {
			evaluate: /\{\{([\s\S]+?\}?)\}\}/g,
			interpolate: /\{\{=([\s\S]+?)\}\}/g,
			encode: /\{\{!([\s\S]+?)\}\}/g,
			use: /\{\{#([\s\S]+?)\}\}/g,
			useParams: /(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,
			define: /\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,
			defineParams: /^\s*([\w$]+):([\s\S]+)/,
			conditional: /\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,
			iterate: /\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,
			varname: "it",
			strip: !0,
			append: !0,
			selfcontained: !1
		},
		template: void 0,
		compile: void 0
	};
	"undefined" != typeof module && module.exports ? module.exports = doT : "function" == typeof define && define.amd ? define(function() {
		return doT
	}) : (h = function() {
		return this || (0, eval)("this")
	}(), h.doT = doT), String.prototype.encodeHTML = encodeHTMLSource();
	var i = {
		append: {
			start: "'+(",
			end: ")+'",
			endencode: "||'').toString().encodeHTML()+'"
		},
		split: {
			start: "';out+=(",
			end: ");out+='",
			endencode: "||'').toString().encodeHTML();out+='"
		}
	},
		skip = /$^/;
	doT.template = function(d, c, f) {
		c = c || doT.templateSettings;
		var g, indv, cse = c.append ? i.append : i.split,
			sid = 0,
			str = c.use || c.define ? resolveDefs(c, d, f || {}) : d;
		str = ("var out='" + (c.strip ? str.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g, " ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g, "") : str).replace(/'|\\/g, "\\$&").replace(c.interpolate || skip, function(m, a) {
			return cse.start + unescape(a) + cse.end
		}).replace(c.encode || skip, function(m, a) {
			return g = !0, cse.start + unescape(a) + cse.endencode
		}).replace(c.conditional || skip, function(m, a, b) {
			return a ? b ? "';}else if(" + unescape(b) + "){out+='" : "';}else{out+='" : b ? "';if(" + unescape(b) + "){out+='" : "';}out+='"
		}).replace(c.iterate || skip, function(m, a, b, c) {
			return a ? (sid += 1, indv = c || "i" + sid, a = unescape(a), "';var arr" + sid + "=" + a + ";if(arr" + sid + "){var " + b + "," + indv + "=-1,l" + sid + "=arr" + sid + ".length-1;while(" + indv + "<l" + sid + "){" + b + "=arr" + sid + "[" + indv + "+=1];out+='") : "';} } out+='"
		}).replace(c.evaluate || skip, function(m, a) {
			return "';" + unescape(a) + "out+='"
		}) + "';return out;").replace(/\n/g, "\\n").replace(/\t/g, "\\t").replace(/\r/g, "\\r").replace(/(\s|;|\}|^|\{)out\+='';/g, "$1").replace(/\+''/g, "").replace(/(\s|;|\}|^|\{)out\+=''\+/g, "$1out+="), g && c.selfcontained && (str = "String.prototype.encodeHTML=(" + encodeHTMLSource.toString() + "());" + str);
		try {
			return new Function(c.varname, str)
		} catch (e) {
			throw "undefined" != typeof console && console.log("Could not create a template function: " + str), e
		}
	}, doT.compile = function(a, b) {
		return doT.template(a, null, b)
	}
}();